apiVersion: dspipelines.opendatahub.io/v1alpha1
kind: DSPipeline
metadata:
  name: testdsp
spec:
  apiServer:
    deploy: true
    image: quay.io/modh/test-api-server-container:test
    applyTektonCustomResource: true
    archiveLogs: false
    artifactImage: quay.io/modh/test-artifact-manager-container:test
    cacheImage: registry.access.redhat.com/ubi8/test-ubi-minimal
    moveResultsImage: testbusybox
    injectDefaultScript: true
    stripEOF: true
    terminateStatus: Cancelled
    trackArtifacts: true
    dbConfigConMaxLifetimeSec: 125
    collectMetrics: true
    autoUpdatePipelineDefaultVersion: true
    resources:
      requests:
        cpu: "1231m"
        memory: "1Gi"
      limits:
        cpu: "2522m"
        memory: "5Gi"
  persistenceAgent:
    deploy: true
    image: quay.io/modh/test-persistenceagent-container:test
    numWorkers: 5
    resources:
      requests:
        cpu: "1233m"
        memory: "1Gi"
      limits:
        cpu: "2524m"
        memory: "5Gi"
  scheduledWorkflow:
    deploy: true
    image: quay.io/modh/test-scheduledworkflow-container:test
    cronScheduleTimezone: EST
    resources:
      requests:
        cpu: "1235m"
        memory: "1Gi"
      limits:
        cpu: "2526m"
        memory: "5Gi"
  viewerCRD:
    deploy: true
    image: quay.io/modh/test-viewercontroller-container:test
    maxNumViewer: 25
    resources:
      requests:
        cpu: "1237m"
        memory: "1Gi"
      limits:
        cpu: "2528m"
        memory: "5Gi"
  mlpipelineUI:
    deploy: true
    image: quay.io/opendatahub/test-frontend-container:beta-ui
    configMap: some-test-configmap
    resources:
      requests:
        cpu: "1239m"
        memory: "1Gi"
      limits:
        cpu: "2530m"
        memory: "5Gi"
  database:
    mariaDB:
      deploy: true
      image: registry.redhat.io/rhel8/test-mariadb-103:test
      username: testuser
      pipelineDBName: randomDBName
      pvcSize: 32Gi
      resources:
        requests:
          cpu: "1212m"
          memory: "1Gi"
        limits:
          cpu: "2554m"
          memory: "5Gi"
  objectStorage:
    minio:
      deploy: true
      image: quay.io/opendatahub/test-minio:test
      bucket: mlpipeline
      pvcSize: 40Gi
      resources:
        requests:
          cpu: "1334m"
          memory: "1Gi"
        limits:
          cpu: "2535m"
          memory: "5Gi"